<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Keuangan - Crave Street</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
        }
        
        .stat-card {
            transition: all 0.3s ease;
            border-left: 4px solid;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #1e3a8a 0%, #0f172a 100%);
        }
        
        .sidebar {
            transition: all 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                z-index: 50;
                height: 100vh;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 40;
            }
            
            .overlay.active {
                display: block;
            }
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            transition: stroke-dashoffset 0.5s ease;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
    </style>
</head>
<body class="gradient-bg text-white min-h-screen">
    <!-- Mobile Menu Button -->
    <div class="lg:hidden fixed top-4 left-4 z-50">
        <button id="menuToggle" class="p-2 rounded-lg bg-blue-600 text-white">
            <i class="fas fa-bars"></i>
        </button>
    </div>

    <!-- Overlay -->
    <div id="overlay" class="overlay"></div>

    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <div class="sidebar w-64 bg-gray-900 p-6 flex flex-col lg:static fixed h-full z-50">
            <!-- Logo -->
            <div class="flex items-center space-x-3 mb-10">
                <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center">
                    <i class="fas fa-chart-line text-white"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold">Crave Street</h1>
                    <p class="text-gray-400 text-xs">Finance Dashboard</p>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="flex-1">
                <ul class="space-y-2">
                    <li>
                        <a href="#" class="flex items-center space-x-3 p-3 rounded-lg bg-blue-600 text-white">
                            <i class="fas fa-home"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center space-x-3 p-3 rounded-lg text-gray-300 hover:bg-gray-800 transition">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Transaksi</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center space-x-3 p-3 rounded-lg text-gray-300 hover:bg-gray-800 transition">
                            <i class="fas fa-chart-pie"></i>
                            <span>Laporan</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center space-x-3 p-3 rounded-lg text-gray-300 hover:bg-gray-800 transition">
                            <i class="fas fa-wallet"></i>
                            <span>Kas & Laba</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center space-x-3 p-3 rounded-lg text-gray-300 hover:bg-gray-800 transition">
                            <i class="fas fa-cog"></i>
                            <span>Pengaturan</span>
                        </a>
                    </li>
                </ul>
            </nav>

            <!-- User Profile -->
            <div class="pt-6 border-t border-gray-700">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-user text-white"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-medium truncate">Admin User</p>
                        <p class="text-xs text-gray-400 truncate">admin@cravestreet.com</p>
                    </div>
                    <button class="text-gray-400 hover:text-white">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 lg:ml-0 p-6">
            <!-- Header -->
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between mb-8">
                <div>
                    <h1 class="text-2xl font-bold">Dashboard Keuangan</h1>
                    <p class="text-gray-400">Ringkasan performa keuangan bisnis Anda</p>
                </div>
                <div class="flex items-center space-x-4 mt-4 lg:mt-0">
                    <div class="relative">
                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        <input type="text" placeholder="Cari..." class="pl-10 pr-4 py-2 bg-gray-800 rounded-lg border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button class="p-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition">
                        <i class="fas fa-bell"></i>
                    </button>
                    <button class="p-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>

            <!-- Stats Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- Total Pemasukan -->
                <div class="stat-card glass-card p-6 border-l-blue-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Total Pemasukan</p>
                            <h3 class="text-2xl font-bold mt-1" id="totalPemasukan">Rp 12.450.000</h3>
                            <p class="text-green-400 text-sm mt-2">
                                <i class="fas fa-arrow-up mr-1"></i>
                                <span id="growthPemasukan">12.5%</span> dari bulan lalu
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-blue-500/20 rounded-full flex items-center justify-center">
                            <i class="fas fa-money-bill-wave text-blue-400"></i>
                        </div>
                    </div>
                </div>

                <!-- Total Pengeluaran -->
                <div class="stat-card glass-card p-6 border-l-red-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Total Pengeluaran</p>
                            <h3 class="text-2xl font-bold mt-1" id="totalPengeluaran">Rp 8.230.000</h3>
                            <p class="text-red-400 text-sm mt-2">
                                <i class="fas fa-arrow-up mr-1"></i>
                                <span id="growthPengeluaran">8.3%</span> dari bulan lalu
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-red-500/20 rounded-full flex items-center justify-center">
                            <i class="fas fa-shopping-cart text-red-400"></i>
                        </div>
                    </div>
                </div>

                <!-- Laba Bersih -->
                <div class="stat-card glass-card p-6 border-l-green-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Laba Bersih</p>
                            <h3 class="text-2xl font-bold mt-1" id="labaBersih">Rp 4.220.000</h3>
                            <p class="text-green-400 text-sm mt-2">
                                <i class="fas fa-arrow-up mr-1"></i>
                                <span id="growthLaba">18.7%</span> dari bulan lalu
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-green-500/20 rounded-full flex items-center justify-center">
                            <i class="fas fa-chart-line text-green-400"></i>
                        </div>
                    </div>
                </div>

                <!-- Kas Usaha -->
                <div class="stat-card glass-card p-6 border-l-purple-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Kas Usaha</p>
                            <h3 class="text-2xl font-bold mt-1" id="kasUsaha">Rp 15.780.000</h3>
                            <p class="text-purple-400 text-sm mt-2">
                                <i class="fas fa-piggy-bank mr-1"></i>
                                <span id="growthKas">5.2%</span> dari bulan lalu
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-purple-500/20 rounded-full flex items-center justify-center">
                            <i class="fas fa-wallet text-purple-400"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts & Analytics -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                <!-- Main Chart -->
                <div class="lg:col-span-2 glass-card p-6 fade-in">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-lg font-semibold">Performa Keuangan 6 Bulan Terakhir</h2>
                        <div class="flex space-x-2">
                            <button class="px-3 py-1 text-sm bg-blue-600 rounded-lg">Bulanan</button>
                            <button class="px-3 py-1 text-sm bg-gray-700 rounded-lg hover:bg-gray-600">Tahunan</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="financeChart"></canvas>
                    </div>
                </div>

                <!-- Distribution & Progress -->
                <div class="space-y-6">
                    <!-- Distribution Chart -->
                    <div class="glass-card p-6 fade-in">
                        <h2 class="text-lg font-semibold mb-4">Distribusi Keuangan</h2>
                        <div class="chart-container">
                            <canvas id="distributionChart"></canvas>
                        </div>
                    </div>

                    <!-- Laba Progress -->
                    <div class="glass-card p-6 fade-in">
                        <h2 class="text-lg font-semibold mb-4">Target Laba Bulanan</h2>
                        <div class="flex items-center justify-center">
                            <div class="relative">
                                <svg class="w-32 h-32 progress-ring">
                                    <circle
                                        class="progress-ring-circle"
                                        stroke="url(#gradient)"
                                        stroke-width="8"
                                        fill="transparent"
                                        r="56"
                                        cx="64"
                                        cy="64"
                                        stroke-dasharray="352"
                                        stroke-dashoffset="105.6"
                                    />
                                    <defs>
                                        <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" stop-color="#10b981" />
                                            <stop offset="100%" stop-color="#3b82f6" />
                                        </linearGradient>
                                    </defs>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <div class="text-center">
                                        <p class="text-2xl font-bold">70%</p>
                                        <p class="text-gray-400 text-sm">Tercapai</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4 text-center">
                            <p class="text-gray-400">Target: Rp 6.000.000</p>
                            <p class="text-green-400 font-semibold">Tercapai: Rp 4.220.000</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Transactions & Quick Actions -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Recent Transactions -->
                <div class="lg:col-span-2 glass-card p-6 fade-in">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-lg font-semibold">Transaksi Terbaru</h2>
                        <button class="text-blue-400 hover:text-blue-300 text-sm font-medium">
                            Lihat Semua <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                    <div class="space-y-4">
                        <!-- Transaction Items -->
                        <div class="flex items-center justify-between p-4 bg-gray-800/50 rounded-lg">
                            <div class="flex items-center space-x-4">
                                <div class="w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-arrow-down text-green-400"></i>
                                </div>
                                <div>
                                    <p class="font-medium">Penjualan Makanan</p>
                                    <p class="text-gray-400 text-sm">12 Mar 2024 • 14:30</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-semibold text-green-400">+ Rp 450.000</p>
                                <p class="text-gray-400 text-sm">Pemasukan</p>
                            </div>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-gray-800/50 rounded-lg">
                            <div class="flex items-center space-x-4">
                                <div class="w-10 h-10 bg-red-500/20 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-arrow-up text-red-400"></i>
                                </div>
                                <div>
                                    <p class="font-medium">Bahan Baku</p>
                                    <p class="text-gray-400 text-sm">12 Mar 2024 • 10:15</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-semibold text-red-400">- Rp 280.000</p>
                                <p class="text-gray-400 text-sm">Pengeluaran</p>
                            </div>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-gray-800/50 rounded-lg">
                            <div class="flex items-center space-x-4">
                                <div class="w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-arrow-down text-green-400"></i>
                                </div>
                                <div>
                                    <p class="font-medium">Penjualan Minuman</p>
                                    <p class="text-gray-400 text-sm">11 Mar 2024 • 18:45</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-semibold text-green-400">+ Rp 320.000</p>
                                <p class="text-gray-400 text-sm">Pemasukan</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions & Summary -->
                <div class="space-y-6">
                    <!-- Quick Actions -->
                    <div class="glass-card p-6 fade-in">
                        <h2 class="text-lg font-semibold mb-4">Aksi Cepat</h2>
                        <div class="grid grid-cols-2 gap-3">
                            <button class="p-4 bg-blue-600 rounded-lg hover:bg-blue-700 transition text-center">
                                <i class="fas fa-plus text-lg mb-2"></i>
                                <p class="text-sm">Tambah Transaksi</p>
                            </button>
                            <button class="p-4 bg-green-600 rounded-lg hover:bg-green-700 transition text-center">
                                <i class="fas fa-file-export text-lg mb-2"></i>
                                <p class="text-sm">Export Laporan</p>
                            </button>
                            <button class="p-4 bg-purple-600 rounded-lg hover:bg-purple-700 transition text-center">
                                <i class="fas fa-chart-bar text-lg mb-2"></i>
                                <p class="text-sm">Analisis Data</p>
                            </button>
                            <button class="p-4 bg-red-600 rounded-lg hover:bg-red-700 transition text-center">
                                <i class="fas fa-share-alt text-lg mb-2"></i>
                                <p class="text-sm">Bagikan Laporan</p>
                            </button>
                        </div>
                    </div>

                    <!-- Financial Summary -->
                    <div class="glass-card p-6 fade-in">
                        <h2 class="text-lg font-semibold mb-4">Ringkasan Keuangan</h2>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">Rata-rata Harian</span>
                                <span class="font-semibold">Rp 415.000</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">Transaksi/Bulan</span>
                                <span class="font-semibold">128</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">Profit Margin</span>
                                <span class="font-semibold text-green-400">34%</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">ROI</span>
                                <span class="font-semibold text-green-400">28.5%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAzzr0ChjdVi7m4Ge-EFm3OK43ASujjZ40",
            authDomain: "crave-street-id.firebaseapp.com",
            projectId: "crave-street-id",
            storageBucket: "crave-street-id.firebasestorage.app",
            messagingSenderId: "221955592583",
            appId: "1:221955592583:web:43dc59d791e750095cc322",
            measurementId: "G-WCRQGLW47B"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // Mobile Menu Toggle
        document.getElementById('menuToggle').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.toggle('active');
            document.getElementById('overlay').classList.toggle('active');
        });

        document.getElementById('overlay').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.remove('active');
            this.classList.remove('active');
        });

        // Initialize Charts
        const financeChart = new Chart(
            document.getElementById('financeChart'),
            {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun'],
                    datasets: [
                        {
                            label: 'Pemasukan',
                            data: [8500000, 9200000, 10200000, 9800000, 11200000, 12450000],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Pengeluaran',
                            data: [6200000, 5800000, 7100000, 6500000, 7800000, 8230000],
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#9ca3af',
                                font: {
                                    family: 'Inter'
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#9ca3af'
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#9ca3af',
                                callback: function(value) {
                                    return 'Rp ' + (value / 1000000).toFixed(1) + 'JT';
                                }
                            }
                        }
                    }
                }
            }
        );

        const distributionChart = new Chart(
            document.getElementById('distributionChart'),
            {
                type: 'doughnut',
                data: {
                    labels: ['Bahan Baku', 'Operasional', 'Gaji', 'Lainnya'],
                    datasets: [{
                        data: [45, 25, 20, 10],
                        backgroundColor: [
                            '#3b82f6',
                            '#10b981',
                            '#f59e0b',
                            '#ef4444'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#9ca3af',
                                font: {
                                    family: 'Inter'
                                }
                            }
                        }
                    }
                }
            }
        );

        // Simulate real-time data updates
        function updateDashboardData() {
            // In a real app, this would fetch from Firebase
            const newPemasukan = 12450000 + Math.floor(Math.random() * 500000);
            const newPengeluaran = 8230000 + Math.floor(Math.random() * 300000);
            const newLaba = newPemasukan - newPengeluaran;
            
            document.getElementById('totalPemasukan').textContent = formatRupiah(newPemasukan);
            document.getElementById('totalPengeluaran').textContent = formatRupiah(newPengeluaran);
            document.getElementById('labaBersih').textContent = formatRupiah(newLaba);
            
            // Add pulse animation to updated elements
            ['totalPemasukan', 'totalPengeluaran', 'labaBersih'].forEach(id => {
                const element = document.getElementById(id);
                element.classList.add('pulse');
                setTimeout(() => element.classList.remove('pulse'), 2000);
            });
        }

        // Format Rupiah helper function
        function formatRupiah(amount) {
            return 'Rp ' + amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');
        }

        // Update data every 30 seconds (simulated)
        setInterval(updateDashboardData, 30000);

        // Initial data load simulation
        setTimeout(() => {
            updateDashboardData();
        }, 1000);

        // Add fade-in animation to cards on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('fade-in');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.glass-card').forEach(card => {
            observer.observe(card);
        });

        // Firebase Data Integration (Example)
        async function loadFinanceData() {
            try {
                // Example: Load transactions from Firestore
                const transactionsSnapshot = await db.collection('transactions')
                    .orderBy('date', 'desc')
                    .limit(10)
                    .get();
                
                // Example: Load financial summary
                const summaryDoc = await db.collection('financialSummary').doc('current').get();
                
                // Update UI with real data
                if (summaryDoc.exists) {
                    const data = summaryDoc.data();
                    // Update your dashboard elements with real data
                }
                
            } catch (error) {
                console.error('Error loading finance data:', error);
            }
        }

        // Load data when page loads
        document.addEventListener('DOMContentLoaded', loadFinanceData);
    </script>
</body>
</html>
