<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VLCrave Express - Layanan Delivery Terpercaya</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="VLCrave Express">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- Firebase App -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .active-nav {
            background-color: #3b82f6;
            color: white;
        }
        
        .nav-link {
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            background-color: #3b82f6;
            color: white;
            border-radius: 8px;
        }
        
        .price-table {
            border-collapse: collapse;
            width: 100%;
        }
        
        .price-table th, .price-table td {
            padding: 12px 15px;
            text-align: left;
        }
        
        .price-table tr:nth-child(even) {
            background-color: #f8fafc;
        }
        
        .price-table tr:hover {
            background-color: #f1f5f9;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Partner Logo Styles */
        .partner-logo {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 50%;
            background: white;
            padding: 4px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 3px solid #f8fafc;
        }
        
        /* PWA Install Prompt */
        .install-prompt {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            padding: 15px;
            z-index: 1000;
            max-width: 300px;
            animation: slideInUp 0.3s ease-out;
        }
        
        @keyframes slideInUp {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p class="text-gray-600 font-semibold">Memuat data...</p>
    </div>

    <!-- PWA Install Prompt -->
    <div id="installPrompt" class="install-prompt hidden">
        <div class="flex items-center mb-3">
            <i class="fas fa-mobile-alt text-blue-500 text-xl mr-3"></i>
            <div>
                <h3 class="font-bold text-gray-800">Install VLCrave Express</h3>
                <p class="text-sm text-gray-600">Add to home screen for quick access</p>
            </div>
        </div>
        <div class="flex space-x-2">
            <button id="installCancel" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg text-sm font-medium">Nanti</button>
            <button id="installConfirm" class="flex-1 bg-blue-500 text-white py-2 rounded-lg text-sm font-medium">Install</button>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-blue-600 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fas fa-shipping-fast text-2xl"></i>
                <h1 class="text-xl font-bold">VLCrave Express</h1>
            </div>
            <button id="menu-toggle" class="md:hidden text-xl">
                <i class="fas fa-bars"></i>
            </button>
            <nav id="main-nav" class="hidden md:flex space-x-6">
                <a href="#harga" class="nav-link px-3 py-2 rounded">Harga Ongkir</a>
                <a href="#area" class="nav-link px-3 py-2 rounded">Area Layanan</a>
                <a href="#jam" class="nav-link px-3 py-2 rounded">Jam Operasional</a>
                <a href="#layanan" class="nav-link px-3 py-2 rounded">Daftar Layanan</a>
                <a href="#partner" class="nav-link px-3 py-2 rounded">Partner Kami</a>
                <a href="#kontak" class="nav-link px-3 py-2 rounded">Kontak</a>
            </nav>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="md:hidden hidden bg-blue-700 px-4 py-2">
            <div class="flex flex-col space-y-2">
                <a href="#harga" class="nav-link px-3 py-2 rounded">Harga Ongkir</a>
                <a href="#area" class="nav-link px-3 py-2 rounded">Area Layanan</a>
                <a href="#jam" class="nav-link px-3 py-2 rounded">Jam Operasional</a>
                <a href="#layanan" class="nav-link px-3 py-2 rounded">Daftar Layanan</a>
                <a href="#partner" class="nav-link px-3 py-2 rounded">Partner Kami</a>
                <a href="#kontak" class="nav-link px-3 py-2 rounded">Kontak</a>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="bg-gradient-to-r from-blue-500 to-purple-600 text-white py-16 md:py-24">
        <div class="container mx-auto px-4 text-center fade-in">
            <h1 class="text-4xl md:text-6xl font-bold mb-4">VLCrave Express</h1>
            <p class="text-xl md:text-2xl mb-8">Layanan Delivery Terpercaya di Kabupaten Bangka</p>
            <button id="cta-button" class="bg-white text-blue-600 font-bold py-3 px-8 rounded-full shadow-lg hover:bg-gray-100 transition duration-300 transform hover:scale-105">
                Pesan Sekarang <i class="fas fa-arrow-right ml-2"></i>
            </button>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-12">
        <!-- Harga Ongkir Section -->
        <section id="harga" class="mb-16 fade-in">
            <h2 class="text-3xl font-bold text-center mb-10 text-gray-800">Daftar Harga Ongkir</h2>
            
            <!-- Pencarian Desa/Kecamatan -->
            <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <div class="text-center mb-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Cek Ongkir Berdasarkan Lokasi</h3>
                    <p class="text-gray-600">Pilih kecamatan dan desa di Kabupaten Bangka untuk melihat harga ongkir</p>
                </div>
                
                <div class="max-w-2xl mx-auto">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div>
                            <label class="block text-gray-700 mb-2">Kecamatan:</label>
                            <select id="kecamatan-select" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">Pilih Kecamatan</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">Desa:</label>
                            <select id="desa-select" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" disabled>
                                <option value="">Pilih Desa</option>
                            </select>
                        </div>
                    </div>
                    
                    <button id="check-price" class="w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition duration-300 flex items-center justify-center">
                        <i class="fas fa-search mr-2"></i> Cek Harga Ongkir
                    </button>
                    
                    <div id="price-result" class="mt-6 p-6 bg-green-50 rounded-lg border border-green-200 hidden">
                        <div class="text-center">
                            <i class="fas fa-check-circle text-green-500 text-4xl mb-4"></i>
                            <h4 class="text-xl font-bold text-green-800 mb-2">Harga Ongkir Ditemukan</h4>
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-gray-700">Lokasi:</span>
                                <span id="result-location" class="font-semibold text-right"></span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700">Harga Ongkir:</span>
                                <span id="result-price" class="font-semibold text-blue-600 text-2xl"></span>
                            </div>
                            
                            <button id="order-button" class="w-full mt-4 bg-green-500 text-white py-3 rounded-lg hover:bg-green-600 transition duration-300">
                                <i class="fas fa-shopping-cart mr-2"></i> Pesan Sekarang
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tabel Harga Ongkir -->
            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="price-table">
                        <thead class="bg-blue-500 text-white">
                            <tr>
                                <th class="py-4 px-6 text-left">Kecamatan</th>
                                <th class="py-4 px-6 text-left">Desa/Kelurahan</th>
                                <th class="py-4 px-6 text-right">Harga Ongkir</th>
                            </tr>
                        </thead>
                        <tbody id="price-table-body">
                            <!-- Data akan diisi oleh JavaScript dari Firestore -->
                            <tr>
                                <td colspan="3" class="text-center py-8">
                                    <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                                    <p class="text-gray-500">Memuat data harga ongkir...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="p-4 bg-blue-50 text-center">
                    <p class="text-blue-700">
                        <i class="fas fa-info-circle mr-2"></i>
                        Harga dapat berubah sewaktu-waktu. Informasi lebih lanjut hubungi kami.
                    </p>
                </div>
            </div>
        </section>

        <!-- Area Layanan Section -->
        <section id="area" class="mb-16 fade-in">
            <h2 class="text-3xl font-bold text-center mb-10 text-gray-800">Area Layanan</h2>
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="text-center mb-8">
                    <p class="text-gray-600 text-lg">Kami melayani pengiriman di seluruh wilayah Kabupaten Bangka</p>
                </div>
                
                <div id="area-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Data akan diisi oleh JavaScript dari Firestore -->
                    <div class="col-span-full text-center py-8">
                        <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                        <p class="text-gray-500">Memuat data area layanan...</p>
                    </div>
                </div>
                
                <div class="mt-8 text-center">
                    <p class="text-gray-600">Total <span id="total-desa" class="font-bold text-blue-600">0 Desa</span> yang sudah kami layani di Kabupaten Bangka</p>
                </div>
            </div>
        </section>

        <!-- Jam Operasional Section -->
        <section id="jam" class="mb-16 fade-in">
            <h2 class="text-3xl font-bold text-center mb-10 text-gray-800">Jam Operasional</h2>
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div id="operational-hours-container">
                    <!-- Data akan diisi oleh JavaScript dari Firestore -->
                    <div class="text-center py-8">
                        <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                        <p class="text-gray-500">Memuat data jam operasional...</p>
                    </div>
                </div>
                <div class="mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                    <p class="text-yellow-700 text-center">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        Layanan dapat tutup sewaktu-waktu tanpa pemberitahuan awal
                    </p>
                </div>
            </div>
        </section>

        <!-- Daftar Layanan Section -->
        <section id="layanan" class="mb-16 fade-in">
            <h2 class="text-3xl font-bold text-center mb-10 text-gray-800">Daftar Layanan</h2>
            <div id="services-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Data akan diisi oleh JavaScript dari Firestore -->
                <div class="col-span-full text-center py-8">
                    <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                    <p class="text-gray-500">Memuat data layanan...</p>
                </div>
            </div>
        </section>

        <!-- Partner Section -->
        <section id="partner" class="mb-16 fade-in">
            <h2 class="text-3xl font-bold text-center mb-10 text-gray-800">Partner Kami</h2>
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="text-center mb-8">
                    <p class="text-gray-600 text-lg">Bekerja sama dengan berbagai mitra terpercaya untuk memberikan pelayanan terbaik</p>
                </div>
                
                <div id="partners-container" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Data akan diisi oleh JavaScript dari Firestore -->
                    <div class="col-span-full text-center py-8">
                        <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                        <p class="text-gray-500">Memuat data partner...</p>
                    </div>
                </div>
                
                <div class="text-center mt-8">
                    <p class="text-gray-600">Ingin menjadi partner kami? 
                        <a href="#kontak" class="text-blue-500 hover:text-blue-600 font-medium">Hubungi kami</a>
                    </p>
                </div>
            </div>
        </section>

        <!-- Kontak Section -->
        <section id="kontak" class="mb-16 fade-in">
            <h2 class="text-3xl font-bold text-center mb-10 text-gray-800">Kontak Kami</h2>
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div id="contact-container" class="flex flex-col md:flex-row items-center justify-center space-y-6 md:space-y-0 md:space-x-12">
                    <!-- Data akan diisi oleh JavaScript dari Firestore -->
                    <div class="text-center py-8">
                        <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                        <p class="text-gray-500">Memuat data kontak...</p>
                    </div>
                </div>
                
                <div class="mt-8 text-center">
                    <button id="contact-button" class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition duration-300">
                        <i class="fab fa-whatsapp mr-2"></i> Hubungi via WhatsApp
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-shipping-fast text-2xl"></i>
                        <h2 class="text-xl font-bold">VLCrave Express</h2>
                    </div>
                    <p class="mt-2 text-gray-400">Layanan Delivery Terpercaya di Kabupaten Bangka</p>
                </div>
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300">
                        <i class="fab fa-facebook text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300">
                        <i class="fab fa-whatsapp text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300">
                        <i class="fab fa-instagram text-xl"></i>
                    </a>
                </div>
            </div>
            <div class="mt-6 pt-6 border-t border-gray-700 text-center text-gray-400">
                <p>&copy; 2023 VLCrave Express. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA1kevuJ9mRJ8le8uPXin11uUqJ6sOLopY",
            authDomain: "vlcrave-whatsapp-order.firebaseapp.com",
            projectId: "vlcrave-whatsapp-order",
            storageBucket: "vlcrave-whatsapp-order.firebasestorage.app",
            messagingSenderId: "796602954067",
            appId: "1:796602954067:web:e10a110ae904decdc471a6",
            measurementId: "G-XLWNDN39ZD"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Global variables to store data
        let shippingData = {};
        let contactData = {};
        let operationalHours = [];
        let services = [];
        let partners = [];
        let areas = [];

        // Load all data from Firestore
        async function loadAllData() {
            try {
                console.log('Loading data from Firestore...');
                
                // Load shipping prices
                const shippingSnapshot = await db.collection('shipping_prices').get();
                shippingData = {};
                shippingSnapshot.forEach(doc => {
                    const data = doc.data();
                    shippingData[data.kecamatan] = data.desa;
                });
                console.log('Shipping data loaded:', shippingData);
                
                // Load contact information
                const contactSnapshot = await db.collection('contact_info').doc('main').get();
                contactData = contactSnapshot.exists ? contactSnapshot.data() : {};
                console.log('Contact data loaded:', contactData);
                
                // Load operational hours
                const hoursSnapshot = await db.collection('operational_hours').orderBy('order').get();
                operationalHours = [];
                hoursSnapshot.forEach(doc => {
                    operationalHours.push(doc.data());
                });
                console.log('Operational hours loaded:', operationalHours);
                
                // Load services
                const servicesSnapshot = await db.collection('services').orderBy('order').get();
                services = [];
                servicesSnapshot.forEach(doc => {
                    services.push(doc.data());
                });
                console.log('Services loaded:', services);
                
                // Load partners
                const partnersSnapshot = await db.collection('partners').orderBy('order').get();
                partners = [];
                partnersSnapshot.forEach(doc => {
                    partners.push(doc.data());
                });
                console.log('Partners loaded:', partners);
                
                // Load areas
                const areasSnapshot = await db.collection('areas').orderBy('order').get();
                areas = [];
                areasSnapshot.forEach(doc => {
                    areas.push(doc.data());
                });
                console.log('Areas loaded:', areas);
                
                // Update UI with loaded data
                updateUIWithData();
                
                // Hide loading overlay
                document.getElementById('loadingOverlay').style.display = 'none';
                
            } catch (error) {
                console.error('Error loading data from Firestore:', error);
                Swal.fire({
                    title: 'Error!',
                    text: 'Gagal memuat data. Silakan refresh halaman.',
                    icon: 'error',
                    confirmButtonText: 'Refresh',
                    allowOutsideClick: false
                }).then(() => {
                    window.location.reload();
                });
            }
        }

        // Update UI with loaded data
        function updateUIWithData() {
            updateShippingData();
            updateContactInfo();
            updateOperationalHours();
            updateServices();
            updatePartners();
            updateAreas();
        }

        // Update shipping data in UI
        function updateShippingData() {
            // Populate kecamatan dropdown
            const kecamatanSelect = document.getElementById('kecamatan-select');
            kecamatanSelect.innerHTML = '<option value="">Pilih Kecamatan</option>';
            Object.keys(shippingData).forEach(kecamatan => {
                const option = document.createElement('option');
                option.value = kecamatan;
                option.textContent = kecamatan;
                kecamatanSelect.appendChild(option);
            });

            // Populate price table
            const priceTableBody = document.getElementById('price-table-body');
            priceTableBody.innerHTML = '';
            
            Object.keys(shippingData).forEach(kecamatan => {
                Object.keys(shippingData[kecamatan]).forEach(desa => {
                    const price = shippingData[kecamatan][desa];
                    
                    const row = document.createElement('tr');
                    row.className = 'border-b';
                    
                    row.innerHTML = `
                        <td class="py-3 px-6">${kecamatan}</td>
                        <td class="py-3 px-6">${desa}</td>
                        <td class="py-3 px-6 text-right font-semibold text-blue-600">Rp ${price.toLocaleString('id-ID')}</td>
                    `;
                    
                    priceTableBody.appendChild(row);
                });
            });
        }

        // Update contact information
        function updateContactInfo() {
            const contactContainer = document.getElementById('contact-container');
            contactContainer.innerHTML = '';
            
            if (contactData.whatsapp) {
                const whatsappDiv = document.createElement('div');
                whatsappDiv.className = 'flex items-center';
                whatsappDiv.innerHTML = `
                    <div class="bg-green-100 w-12 h-12 rounded-full flex items-center justify-center mr-4">
                        <i class="fab fa-whatsapp text-green-600 text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-600">WhatsApp</p>
                        <p class="text-lg font-semibold">${contactData.whatsapp}</p>
                    </div>
                `;
                contactContainer.appendChild(whatsappDiv);
            }
            
            if (contactData.facebook) {
                const facebookDiv = document.createElement('div');
                facebookDiv.className = 'flex items-center';
                facebookDiv.innerHTML = `
                    <div class="bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mr-4">
                        <i class="fab fa-facebook text-blue-600 text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-600">Facebook</p>
                        <p class="text-lg font-semibold">${contactData.facebook}</p>
                    </div>
                `;
                contactContainer.appendChild(facebookDiv);
            }
            
            // Update WhatsApp button
            if (contactData.whatsapp) {
                const whatsappNumber = contactData.whatsapp.replace(/\D/g, '');
                document.getElementById('contact-button').addEventListener('click', function() {
                    window.open(`https://wa.me/${whatsappNumber}`, '_blank');
                });
            }
        }

        // Update operational hours
        function updateOperationalHours() {
            const container = document.getElementById('operational-hours-container');
            container.innerHTML = '';
            
            if (operationalHours.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">Data jam operasional tidak tersedia</p>';
                return;
            }
            
            const table = document.createElement('table');
            table.className = 'w-full text-left';
            table.innerHTML = `
                <thead class="bg-blue-50">
                    <tr>
                        <th class="py-3 px-4 font-semibold">Hari</th>
                        <th class="py-3 px-4 font-semibold">Jam Operasional</th>
                    </tr>
                </thead>
                <tbody id="operational-hours-body">
                </tbody>
            `;
            
            const tbody = table.querySelector('#operational-hours-body');
            operationalHours.forEach(hour => {
                const row = document.createElement('tr');
                row.className = 'border-b';
                row.innerHTML = `
                    <td class="py-3 px-4">${hour.day}</td>
                    <td class="py-3 px-4">${hour.hours}</td>
                `;
                tbody.appendChild(row);
            });
            
            container.appendChild(table);
        }

        // Update services
        function updateServices() {
            const container = document.getElementById('services-container');
            container.innerHTML = '';
            
            services.forEach(service => {
                const serviceDiv = document.createElement('div');
                serviceDiv.className = 'bg-white rounded-lg shadow-md p-6 text-center card-hover';
                serviceDiv.innerHTML = `
                    <div class="bg-${service.color}-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="${service.icon} text-${service.color}-600 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">${service.name}</h3>
                    <p class="text-gray-600">${service.description}</p>
                `;
                container.appendChild(serviceDiv);
            });
        }

        // Update partners
        function updatePartners() {
            const container = document.getElementById('partners-container');
            container.innerHTML = '';
            
            partners.forEach(partner => {
                const partnerDiv = document.createElement('div');
                partnerDiv.className = 'bg-gray-50 rounded-lg p-6 flex items-center justify-between card-hover';
                partnerDiv.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <img src="${partner.logo}" alt="${partner.name}" class="partner-logo">
                        <div>
                            <h3 class="font-bold text-lg">${partner.name}</h3>
                            <p class="text-gray-600 text-sm">${partner.description}</p>
                        </div>
                    </div>
                    <button class="partner-order bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition duration-300" data-partner="${partner.name}">
                        Pesan <i class="fas fa-arrow-right ml-1"></i>
                    </button>
                `;
                container.appendChild(partnerDiv);
            });
            
            // Add event listeners to partner order buttons
            document.querySelectorAll('.partner-order').forEach(button => {
                button.addEventListener('click', function() {
                    const partnerName = this.getAttribute('data-partner');
                    handlePartnerOrder(partnerName);
                });
            });
        }

        // Update areas
        function updateAreas() {
            const container = document.getElementById('area-container');
            container.innerHTML = '';
            
            let totalDesa = 0;
            const colors = ['blue', 'green', 'orange', 'purple', 'red', 'indigo'];
            
            areas.forEach((area, index) => {
                totalDesa += area.villageCount;
                const color = colors[index % colors.length];
                
                const areaDiv = document.createElement('div');
                areaDiv.className = 'bg-gray-50 rounded-lg p-6 text-center card-hover';
                areaDiv.innerHTML = `
                    <div class="bg-${color}-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-map-marker-alt text-${color}-600 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">${area.name}</h3>
                    <p class="text-gray-600">${area.villageCount} Desa</p>
                    ${area.isCenter ? '<p class="text-sm text-blue-600 font-semibold mt-2">Pusat Layanan</p>' : ''}
                `;
                container.appendChild(areaDiv);
            });
            
            // Update total desa count
            document.getElementById('total-desa').textContent = `${totalDesa} Desa`;
        }

        // Handle partner order
        function handlePartnerOrder(partnerName) {
            if (!contactData.whatsapp) {
                Swal.fire('Error', 'Nomor WhatsApp tidak tersedia', 'error');
                return;
            }
            
            const whatsappNumber = contactData.whatsapp.replace(/\D/g, '');
            const message = `Halo VLCrave Express, saya ingin memesan dari ${partnerName}. Bisa info menu dan harga?`;
            const encodedMessage = encodeURIComponent(message);
            
            Swal.fire({
                title: `Pesan dari ${partnerName}`,
                text: 'Anda akan diarahkan ke WhatsApp untuk memesan',
                icon: 'info',
                showCancelButton: true,
                confirmButtonColor: '#25D366',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Lanjutkan ke WhatsApp',
                cancelButtonText: 'Batal'
            }).then((result) => {
                if (result.isConfirmed) {
                    window.open(`https://wa.me/${whatsappNumber}?text=${encodedMessage}`, '_blank');
                }
            });
        }

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(function(error) {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        const installPrompt = document.getElementById('installPrompt');
        const installConfirm = document.getElementById('installConfirm');
        const installCancel = document.getElementById('installCancel');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installPrompt.classList.remove('hidden');
        });

        installConfirm.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    console.log('User accepted the install prompt');
                }
                deferredPrompt = null;
                installPrompt.classList.add('hidden');
            }
        });

        installCancel.addEventListener('click', () => {
            installPrompt.classList.add('hidden');
        });

        // Mobile menu toggle
        document.getElementById('menu-toggle').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                
                window.scrollTo({
                    top: targetElement.offsetTop - 80,
                    behavior: 'smooth'
                });
                
                // Close mobile menu after clicking a link
                document.getElementById('mobile-menu').classList.add('hidden');
            });
        });

        // Active navigation highlighting
        window.addEventListener('scroll', function() {
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('.nav-link');
            
            let currentSection = '';
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                const sectionHeight = section.clientHeight;
                if (pageYOffset >= sectionTop && pageYOffset < sectionTop + sectionHeight) {
                    currentSection = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active-nav');
                if (link.getAttribute('href') === `#${currentSection}`) {
                    link.classList.add('active-nav');
                }
            });
        });

        // CTA Button with SweetAlert
        document.getElementById('cta-button').addEventListener('click', function() {
            if (!contactData.whatsapp) {
                Swal.fire('Error', 'Nomor WhatsApp tidak tersedia', 'error');
                return;
            }
            
            const whatsappNumber = contactData.whatsapp.replace(/\D/g, '');
            
            Swal.fire({
                title: 'Pesan Sekarang!',
                text: 'Hubungi kami via WhatsApp untuk memesan layanan delivery',
                icon: 'info',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Hubungi WhatsApp',
                cancelButtonText: 'Nanti Saja'
            }).then((result) => {
                if (result.isConfirmed) {
                    window.open(`https://wa.me/${whatsappNumber}`, '_blank');
                }
            });
        });

        // Populate desa dropdown based on selected kecamatan
        document.getElementById('kecamatan-select').addEventListener('change', function() {
            const desaSelect = document.getElementById('desa-select');
            desaSelect.innerHTML = '<option value="">Pilih Desa</option>';
            
            if (this.value && shippingData[this.value]) {
                desaSelect.disabled = false;
                Object.keys(shippingData[this.value]).forEach(desa => {
                    const option = document.createElement('option');
                    option.value = desa;
                    option.textContent = desa;
                    desaSelect.appendChild(option);
                });
            } else {
                desaSelect.disabled = true;
            }
            
            // Reset price result
            document.getElementById('price-result').classList.add('hidden');
        });

        // Check price functionality
        document.getElementById('check-price').addEventListener('click', function() {
            const kecamatan = document.getElementById('kecamatan-select').value;
            const desa = document.getElementById('desa-select').value;
            
            if (!kecamatan || !desa) {
                Swal.fire({
                    title: 'Peringatan!',
                    text: 'Silakan pilih kecamatan dan desa terlebih dahulu',
                    icon: 'warning',
                    confirmButtonColor: '#3085d6'
                });
                return;
            }
            
            if (!shippingData[kecamatan] || !shippingData[kecamatan][desa]) {
                Swal.fire({
                    title: 'Error!',
                    text: 'Data harga ongkir tidak ditemukan untuk lokasi tersebut',
                    icon: 'error',
                    confirmButtonColor: '#3085d6'
                });
                return;
            }
            
            const price = shippingData[kecamatan][desa];
            const priceResult = document.getElementById('price-result');
            const resultLocation = document.getElementById('result-location');
            const resultPrice = document.getElementById('result-price');
            
            resultLocation.textContent = `${desa}, ${kecamatan}`;
            resultPrice.textContent = `Rp ${price.toLocaleString('id-ID')}`;
            
            priceResult.classList.remove('hidden');
            
            // Scroll to price result
            priceResult.scrollIntoView({ behavior: 'smooth', block: 'center' });
        });

        // Order button in price result
        document.getElementById('order-button').addEventListener('click', function() {
            if (!contactData.whatsapp) {
                Swal.fire('Error', 'Nomor WhatsApp tidak tersedia', 'error');
                return;
            }
            
            const location = document.getElementById('result-location').textContent;
            const price = document.getElementById('result-price').textContent;
            const whatsappNumber = contactData.whatsapp.replace(/\D/g, '');
            
            const message = `Halo VLCrave Express, saya ingin memesan layanan delivery ke ${location}. Harga ongkir: ${price}. Bisa info lebih lanjut?`;
            const encodedMessage = encodeURIComponent(message);
            window.open(`https://wa.me/${whatsappNumber}?text=${encodedMessage}`, '_blank');
        });

        // Add loading animation to buttons when clicked
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('click', function() {
                const originalText = this.innerHTML;
                
                // Only add loading to certain buttons
                if (this.id === 'check-price' || this.id === 'order-button' || this.classList.contains('partner-order')) {
                    this.innerHTML = '<div class="loading"></div> Memproses...';
                    this.disabled = true;
                    
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.disabled = false;
                    }, 1500);
                }
            });
        });

        // Add intersection observer for fade-in animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Observe all sections for animation
        document.querySelectorAll('section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(20px)';
            section.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
            observer.observe(section);
        });

        // Add scroll to top functionality
        const scrollToTopButton = document.createElement('button');
        scrollToTopButton.innerHTML = '<i class="fas fa-chevron-up"></i>';
        scrollToTopButton.className = 'fixed bottom-6 right-6 bg-blue-500 text-white w-12 h-12 rounded-full shadow-lg hover:bg-blue-600 transition duration-300 opacity-0 pointer-events-none z-40';
        scrollToTopButton.style.transition = 'opacity 0.3s ease';
        document.body.appendChild(scrollToTopButton);

        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                scrollToTopButton.style.opacity = '1';
                scrollToTopButton.style.pointerEvents = 'auto';
            } else {
                scrollToTopButton.style.opacity = '0';
                scrollToTopButton.style.pointerEvents = 'none';
            }
        });

        scrollToTopButton.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Online status indicator
        const onlineStatus = document.createElement('div');
        onlineStatus.className = 'fixed top-20 right-4 bg-green-500 text-white px-3 py-1 rounded-full text-sm font-medium flex items-center space-x-2 z-40';
        onlineStatus.innerHTML = '<i class="fas fa-circle animate-pulse"></i><span>Online</span>';
        document.body.appendChild(onlineStatus);

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadAllData();
        });

        console.log('VLCrave Express website loaded successfully!');
    </script>
</body>
</html>
