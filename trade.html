<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trading Dashboard - MT5</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    html, body { -webkit-font-smoothing: antialiased; scroll-behavior: smooth; }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-gray-800 to-black text-white min-h-screen p-4 sm:p-6 flex flex-col items-center">

  <!-- Header -->
  <header class="w-full max-w-4xl text-center mb-8">
    <h1 class="text-2xl sm:text-4xl font-bold text-yellow-400 drop-shadow-lg">
      ğŸ’¹ VL Trade Monitor
    </h1>
    <p class="text-gray-400 mt-2 text-sm sm:text-base">Terhubung ke MetaTrader 5 â€” Real-time Order Overview</p>
  </header>

  <!-- Total Profit/Loss -->
  <section class="w-full max-w-3xl bg-gray-900 border border-yellow-500 rounded-2xl shadow-lg p-5 sm:p-6 mb-6 text-center">
    <h2 class="text-lg sm:text-xl font-semibold text-yellow-400 mb-2">Total Profit/Loss</h2>
    <p id="totalPL" class="text-3xl sm:text-4xl font-extrabold">+0.00 pips</p>
  </section>

  <!-- Table Open Orders -->
  <section class="w-full max-w-4xl bg-gray-900 border border-yellow-500 rounded-2xl shadow-lg overflow-hidden">
    <table class="w-full text-xs sm:text-sm md:text-base text-center">
      <thead class="bg-yellow-500 text-black font-semibold">
        <tr>
          <th class="py-3">Symbol</th>
          <th class="py-3">Type</th>
          <th class="py-3">Lot</th>
          <th class="py-3">Open Price</th>
          <th class="py-3">Current</th>
          <th class="py-3">P/L (pips)</th>
        </tr>
      </thead>
      <tbody id="ordersTable" class="divide-y divide-yellow-700">
        <tr><td colspan="6" class="py-4 text-gray-400">Memuat data...</td></tr>
      </tbody>
    </table>
  </section>

  <!-- Actions -->
  <section class="w-full max-w-4xl flex flex-col sm:flex-row justify-center gap-3 sm:gap-5 mt-6">
    <button onclick="closeAll()" class="bg-red-600 hover:bg-red-500 text-white font-semibold px-5 py-3 rounded-lg shadow active:scale-95 transition">ğŸš« Close All</button>
    <button onclick="closeHalfProfit()" class="bg-green-600 hover:bg-green-500 text-white font-semibold px-5 py-3 rounded-lg shadow active:scale-95 transition">ğŸ’° Close Half Profit</button>
    <button onclick="closeHalfLoss()" class="bg-yellow-600 hover:bg-yellow-500 text-white font-semibold px-5 py-3 rounded-lg shadow active:scale-95 transition">ğŸ“‰ Close Half Loss</button>
  </section>

  <!-- Footer -->
  <footer class="text-center text-gray-400 text-xs sm:text-sm mt-10">
    <p>Powered by <span class="text-yellow-400 font-semibold">VLCRAVE â¤ï¸</span></p>
  </footer>

  <script>
    // Simulasi data (nanti diganti real API dari MT5)
    const orders = [
      { symbol: "XAUUSD", type: "BUY", lot: 0.10, open: 2400.50, current: 2403.00, pl: +25.0 },
      { symbol: "EURUSD", type: "SELL", lot: 0.20, open: 1.0800, current: 1.0825, pl: -25.0 },
      { symbol: "GBPUSD", type: "BUY", lot: 0.15, open: 1.2700, current: 1.2755, pl: +55.0 },
      { symbol: "USDJPY", type: "SELL", lot: 0.10, open: 150.50, current: 150.80, pl: -30.0 },
    ];

    function renderOrders() {
      const tbody = document.getElementById("ordersTable");
      const totalPL = orders.reduce((a, b) => a + b.pl, 0);
      document.getElementById("totalPL").textContent =
        `${totalPL >= 0 ? "+" : ""}${totalPL.toFixed(2)} pips`;

      tbody.innerHTML = orders.map(o => `
        <tr class="hover:bg-yellow-500/10 transition">
          <td class="py-3">${o.symbol}</td>
          <td class="py-3 ${o.type === 'BUY' ? 'text-green-400' : 'text-red-400'}">${o.type}</td>
          <td class="py-3">${o.lot.toFixed(2)}</td>
          <td class="py-3">${o.open}</td>
          <td class="py-3">${o.current}</td>
          <td class="py-3 font-bold ${o.pl >= 0 ? 'text-green-400' : 'text-red-400'}">${o.pl.toFixed(1)}</td>
        </tr>
      `).join("");
    }

    function closeAll() {
      Swal.fire({
        title: "Tutup Semua Posisi?",
        text: "Semua order akan ditutup.",
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#ef4444",
        cancelButtonColor: "#9ca3af",
        confirmButtonText: "Ya, tutup semua",
      }).then((r) => {
        if (r.isConfirmed) {
          Swal.fire("Berhasil!", "Semua posisi telah ditutup.", "success");
        }
      });
    }

    function closeHalfProfit() {
      const profitOrders = orders.filter(o => o.pl > 0).sort((a, b) => a.pl - b.pl);
      const toClose = profitOrders.slice(0, Math.ceil(profitOrders.length / 2));
      Swal.fire("âœ… Half Profit Closed", `${toClose.length} posisi profit ditutup.`, "success");
    }

    function closeHalfLoss() {
      const lossOrders = orders.filter(o => o.pl < 0).sort((a, b) => a.pl - b.pl).reverse();
      const toClose = lossOrders.slice(0, Math.ceil(lossOrders.length / 2));
      Swal.fire("âš ï¸ Half Loss Closed", `${toClose.length} posisi loss ditutup.`, "info");
    }

    renderOrders();
  </script>
</body>
</html>
