<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VLCrave Express - Admin Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- AOS (Animate On Scroll) -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- Firebase App -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
        }
        
        .sidebar {
            transition: all 0.3s ease;
        }
        
        .sidebar.collapsed {
            width: 70px;
        }
        
        .sidebar.collapsed .sidebar-text {
            display: none;
        }
        
        .sidebar.collapsed .logo-text {
            display: none;
        }
        
        .main-content {
            transition: all 0.3s ease;
        }
        
        .main-content.expanded {
            margin-left: 70px;
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .active-nav {
            background-color: #3b82f6;
            color: white;
        }
        
        .nav-link {
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            background-color: #3b82f6;
            color: white;
            border-radius: 8px;
        }
        
        .data-table {
            border-collapse: collapse;
            width: 100%;
        }
        
        .data-table th, .data-table td {
            padding: 12px 15px;
            text-align: left;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f8fafc;
        }
        
        .data-table tr:hover {
            background-color: #f1f5f9;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        /* Chart Container */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        /* Responsive Table */
        @media (max-width: 768px) {
            .data-table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p class="text-gray-600 font-semibold">Memuat dashboard...</p>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content p-8">
            <div class="text-center mb-6">
                <i class="fas fa-shipping-fast text-blue-500 text-4xl mb-4"></i>
                <h2 class="text-2xl font-bold text-gray-800">Admin Login</h2>
                <p class="text-gray-600">Masuk ke dashboard admin VLCrave Express</p>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 mb-2">Email:</label>
                    <input type="email" id="loginEmail" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                
                <div>
                    <label class="block text-gray-700 mb-2">Password:</label>
                    <input type="password" id="loginPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                
                <button type="submit" class="w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition duration-300 flex items-center justify-center">
                    <i class="fas fa-sign-in-alt mr-2"></i> Masuk
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600 text-sm">Hanya untuk administrator VLCrave Express</p>
            </div>
        </div>
    </div>

    <!-- Main Layout -->
    <div class="flex">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar bg-white shadow-lg h-screen fixed top-0 left-0 w-64 z-40">
            <div class="p-4 border-b border-gray-200 flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-shipping-fast text-blue-500 text-2xl"></i>
                    <h1 class="text-xl font-bold logo-text">VLCrave Admin</h1>
                </div>
                <button id="sidebar-toggle" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <div class="p-4">
                <div class="mb-6 flex items-center space-x-3 bg-blue-50 p-3 rounded-lg">
                    <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="sidebar-text">
                        <p class="font-semibold" id="adminName">Admin User</p>
                        <p class="text-sm text-gray-600">Administrator</p>
                    </div>
                </div>
                
                <nav class="space-y-2">
                    <a href="#" data-section="dashboard" class="nav-link px-3 py-2 rounded flex items-center space-x-3 active-nav">
                        <i class="fas fa-tachometer-alt w-5 text-center"></i>
                        <span class="sidebar-text">Dashboard</span>
                    </a>
                    
                    <a href="#" data-section="shipping" class="nav-link px-3 py-2 rounded flex items-center space-x-3">
                        <i class="fas fa-truck w-5 text-center"></i>
                        <span class="sidebar-text">Harga Ongkir</span>
                    </a>
                    
                    <a href="#" data-section="areas" class="nav-link px-3 py-2 rounded flex items-center space-x-3">
                        <i class="fas fa-map-marker-alt w-5 text-center"></i>
                        <span class="sidebar-text">Area Layanan</span>
                    </a>
                    
                    <a href="#" data-section="hours" class="nav-link px-3 py-2 rounded flex items-center space-x-3">
                        <i class="fas fa-clock w-5 text-center"></i>
                        <span class="sidebar-text">Jam Operasional</span>
                    </a>
                    
                    <a href="#" data-section="services" class="nav-link px-3 py-2 rounded flex items-center space-x-3">
                        <i class="fas fa-concierge-bell w-5 text-center"></i>
                        <span class="sidebar-text">Layanan</span>
                    </a>
                    
                    <a href="#" data-section="partners" class="nav-link px-3 py-2 rounded flex items-center space-x-3">
                        <i class="fas fa-handshake w-5 text-center"></i>
                        <span class="sidebar-text">Partner</span>
                    </a>
                    
                    <a href="#" data-section="contacts" class="nav-link px-3 py-2 rounded flex items-center space-x-3">
                        <i class="fas fa-address-book w-5 text-center"></i>
                        <span class="sidebar-text">Kontak</span>
                    </a>
                    
                    <a href="#" data-section="users" class="nav-link px-3 py-2 rounded flex items-center space-x-3">
                        <i class="fas fa-users w-5 text-center"></i>
                        <span class="sidebar-text">Pengguna</span>
                    </a>
                    
                    <a href="#" id="logoutBtn" class="nav-link px-3 py-2 rounded flex items-center space-x-3 text-red-500 hover:bg-red-500 hover:text-white">
                        <i class="fas fa-sign-out-alt w-5 text-center"></i>
                        <span class="sidebar-text">Keluar</span>
                    </a>
                </nav>
            </div>
        </div>

        <!-- Main Content -->
        <div id="mainContent" class="main-content ml-64 w-full min-h-screen">
            <!-- Header -->
            <header class="bg-white shadow-sm py-4 px-6 flex justify-between items-center">
                <div>
                    <h2 id="pageTitle" class="text-xl font-bold text-gray-800">Dashboard</h2>
                    <p class="text-gray-600 text-sm" id="pageSubtitle">Ringkasan dan statistik VLCrave Express</p>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button id="notificationsBtn" class="text-gray-500 hover:text-gray-700 relative">
                            <i class="fas fa-bell text-xl"></i>
                            <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">3</span>
                        </button>
                    </div>
                    
                    <div class="relative">
                        <button id="profileBtn" class="flex items-center space-x-2 text-gray-700 hover:text-blue-500">
                            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold">
                                <i class="fas fa-user"></i>
                            </div>
                            <span class="font-medium hidden md:inline" id="headerAdminName">Admin</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Dashboard Content -->
            <main class="p-6">
                <!-- Dashboard Section -->
                <section id="dashboard-section" class="section-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-md p-6 card-hover" data-aos="fade-up">
                            <div class="flex justify-between items-center">
                                <div>
                                    <p class="text-gray-500">Total Pesanan</p>
                                    <h3 class="text-2xl font-bold text-gray-800">1,248</h3>
                                </div>
                                <div class="bg-blue-100 p-3 rounded-full">
                                    <i class="fas fa-shopping-cart text-blue-500 text-xl"></i>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-green-500 text-sm">
                                    <i class="fas fa-arrow-up mr-1"></i> 12% dari bulan lalu
                                </p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-md p-6 card-hover" data-aos="fade-up" data-aos-delay="100">
                            <div class="flex justify-between items-center">
                                <div>
                                    <p class="text-gray-500">Pendapatan</p>
                                    <h3 class="text-2xl font-bold text-gray-800">Rp 24,8 Jt</h3>
                                </div>
                                <div class="bg-green-100 p-3 rounded-full">
                                    <i class="fas fa-money-bill-wave text-green-500 text-xl"></i>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-green-500 text-sm">
                                    <i class="fas fa-arrow-up mr-1"></i> 8% dari bulan lalu
                                </p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-md p-6 card-hover" data-aos="fade-up" data-aos-delay="200">
                            <div class="flex justify-between items-center">
                                <div>
                                    <p class="text-gray-500">Pengguna Aktif</p>
                                    <h3 class="text-2xl font-bold text-gray-800">892</h3>
                                </div>
                                <div class="bg-purple-100 p-3 rounded-full">
                                    <i class="fas fa-users text-purple-500 text-xl"></i>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-green-500 text-sm">
                                    <i class="fas fa-arrow-up mr-1"></i> 5% dari bulan lalu
                                </p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-md p-6 card-hover" data-aos="fade-up" data-aos-delay="300">
                            <div class="flex justify-between items-center">
                                <div>
                                    <p class="text-gray-500">Rating</p>
                                    <h3 class="text-2xl font-bold text-gray-800">4.7/5</h3>
                                </div>
                                <div class="bg-yellow-100 p-3 rounded-full">
                                    <i class="fas fa-star text-yellow-500 text-xl"></i>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-green-500 text-sm">
                                    <i class="fas fa-arrow-up mr-1"></i> 0.2 dari bulan lalu
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-md p-6" data-aos="fade-right">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Statistik Pesanan</h3>
                            <div class="chart-container">
                                <canvas id="ordersChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-md p-6" data-aos="fade-left">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Distribusi Layanan</h3>
                            <div class="chart-container">
                                <canvas id="servicesChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6" data-aos="fade-up">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800">Pesanan Terbaru</h3>
                            <button class="text-blue-500 hover:text-blue-700 font-medium">
                                Lihat Semua <i class="fas fa-arrow-right ml-1"></i>
                            </button>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead class="bg-blue-50">
                                    <tr>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">ID Pesanan</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Pelanggan</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Layanan</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Status</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Tanggal</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="py-3 px-4">#VL-001248</td>
                                        <td class="py-3 px-4">Ahmad Fauzi</td>
                                        <td class="py-3 px-4">Makanan Delivery</td>
                                        <td class="py-3 px-4">
                                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium">Selesai</span>
                                        </td>
                                        <td class="py-3 px-4">12 Mar 2023</td>
                                    </tr>
                                    <tr>
                                        <td class="py-3 px-4">#VL-001247</td>
                                        <td class="py-3 px-4">Siti Rahma</td>
                                        <td class="py-3 px-4">Barang Pindahan</td>
                                        <td class="py-3 px-4">
                                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium">Dalam Proses</span>
                                        </td>
                                        <td class="py-3 px-4">11 Mar 2023</td>
                                    </tr>
                                    <tr>
                                        <td class="py-3 px-4">#VL-001246</td>
                                        <td class="py-3 px-4">Budi Santoso</td>
                                        <td class="py-3 px-4">Dokumen Express</td>
                                        <td class="py-3 px-4">
                                            <span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs font-medium">Menunggu</span>
                                        </td>
                                        <td class="py-3 px-4">10 Mar 2023</td>
                                    </tr>
                                    <tr>
                                        <td class="py-3 px-4">#VL-001245</td>
                                        <td class="py-3 px-4">Rina Wijaya</td>
                                        <td class="py-3 px-4">Makanan Delivery</td>
                                        <td class="py-3 px-4">
                                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium">Selesai</span>
                                        </td>
                                        <td class="py-3 px-4">10 Mar 2023</td>
                                    </tr>
                                    <tr>
                                        <td class="py-3 px-4">#VL-001244</td>
                                        <td class="py-3 px-4">Joko Prasetyo</td>
                                        <td class="py-3 px-4">Barang Pindahan</td>
                                        <td class="py-3 px-4">
                                            <span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-medium">Dibatalkan</span>
                                        </td>
                                        <td class="py-3 px-4">9 Mar 2023</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Shipping Prices Section -->
                <section id="shipping-section" class="section-content hidden">
                    <div class="bg-white rounded-xl shadow-md p-6 mb-6" data-aos="fade-up">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800">Kelola Harga Ongkir</h3>
                            <button id="addShippingBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition duration-300">
                                <i class="fas fa-plus mr-2"></i> Tambah Data
                            </button>
                        </div>
                        
                        <div class="mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-gray-700 mb-2">Cari Kecamatan:</label>
                                    <input type="text" id="searchKecamatan" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nama kecamatan...">
                                </div>
                                <div>
                                    <label class="block text-gray-700 mb-2">Cari Desa:</label>
                                    <input type="text" id="searchDesa" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nama desa...">
                                </div>
                                <div>
                                    <label class="block text-gray-700 mb-2">Filter:</label>
                                    <select id="filterShipping" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="all">Semua Data</option>
                                        <option value="publish">Sudah Publikasi</option>
                                        <option value="draft">Draft</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead class="bg-blue-50">
                                    <tr>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Kecamatan</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Desa/Kelurahan</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Harga Ongkir</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Status</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="shipping-table-body">
                                    <!-- Data akan diisi oleh JavaScript dari Firestore -->
                                    <tr>
                                        <td colspan="5" class="text-center py-8">
                                            <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                                            <p class="text-gray-500">Memuat data harga ongkir...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="mt-6 flex justify-between items-center">
                            <p class="text-gray-600">Menampilkan <span id="shipping-count">0</span> data</p>
                            <div class="flex space-x-2">
                                <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition duration-300">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition duration-300">
                                    1
                                </button>
                                <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition duration-300">
                                    2
                                </button>
                                <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition duration-300">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Areas Section -->
                <section id="areas-section" class="section-content hidden">
                    <div class="bg-white rounded-xl shadow-md p-6" data-aos="fade-up">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800">Kelola Area Layanan</h3>
                            <button id="addAreaBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition duration-300">
                                <i class="fas fa-plus mr-2"></i> Tambah Area
                            </button>
                        </div>
                        
                        <div class="mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-gray-700 mb-2">Cari Area:</label>
                                    <input type="text" id="searchArea" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nama area...">
                                </div>
                                <div>
                                    <label class="block text-gray-700 mb-2">Filter:</label>
                                    <select id="filterArea" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="all">Semua Area</option>
                                        <option value="active">Aktif</option>
                                        <option value="inactive">Nonaktif</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead class="bg-blue-50">
                                    <tr>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Nama Area</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Jumlah Desa</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Status</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Pusat Layanan</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="areas-table-body">
                                    <!-- Data akan diisi oleh JavaScript dari Firestore -->
                                    <tr>
                                        <td colspan="5" class="text-center py-8">
                                            <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                                            <p class="text-gray-500">Memuat data area layanan...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Operational Hours Section -->
                <section id="hours-section" class="section-content hidden">
                    <div class="bg-white rounded-xl shadow-md p-6" data-aos="fade-up">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800">Kelola Jam Operasional</h3>
                            <button id="addHourBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition duration-300">
                                <i class="fas fa-plus mr-2"></i> Tambah Jam
                            </button>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead class="bg-blue-50">
                                    <tr>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Hari</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Jam Operasional</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Status</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="hours-table-body">
                                    <!-- Data akan diisi oleh JavaScript dari Firestore -->
                                    <tr>
                                        <td colspan="4" class="text-center py-8">
                                            <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                                            <p class="text-gray-500">Memuat data jam operasional...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Services Section -->
                <section id="services-section" class="section-content hidden">
                    <div class="bg-white rounded-xl shadow-md p-6" data-aos="fade-up">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800">Kelola Layanan</h3>
                            <button id="addServiceBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition duration-300">
                                <i class="fas fa-plus mr-2"></i> Tambah Layanan
                            </button>
                        </div>
                        
                        <div class="mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-gray-700 mb-2">Cari Layanan:</label>
                                    <input type="text" id="searchService" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nama layanan...">
                                </div>
                                <div>
                                    <label class="block text-gray-700 mb-2">Filter:</label>
                                    <select id="filterService" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="all">Semua Layanan</option>
                                        <option value="active">Aktif</option>
                                        <option value="inactive">Nonaktif</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead class="bg-blue-50">
                                    <tr>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Nama Layanan</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Deskripsi</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Status</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="services-table-body">
                                    <!-- Data akan diisi oleh JavaScript dari Firestore -->
                                    <tr>
                                        <td colspan="4" class="text-center py-8">
                                            <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                                            <p class="text-gray-500">Memuat data layanan...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Partners Section -->
                <section id="partners-section" class="section-content hidden">
                    <div class="bg-white rounded-xl shadow-md p-6" data-aos="fade-up">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800">Kelola Partner</h3>
                            <button id="addPartnerBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition duration-300">
                                <i class="fas fa-plus mr-2"></i> Tambah Partner
                            </button>
                        </div>
                        
                        <div class="mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-gray-700 mb-2">Cari Partner:</label>
                                    <input type="text" id="searchPartner" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nama partner...">
                                </div>
                                <div>
                                    <label class="block text-gray-700 mb-2">Filter:</label>
                                    <select id="filterPartner" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="all">Semua Partner</option>
                                        <option value="active">Aktif</option>
                                        <option value="inactive">Nonaktif</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead class="bg-blue-50">
                                    <tr>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Nama Partner</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Deskripsi</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Status</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="partners-table-body">
                                    <!-- Data akan diisi oleh JavaScript dari Firestore -->
                                    <tr>
                                        <td colspan="4" class="text-center py-8">
                                            <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                                            <p class="text-gray-500">Memuat data partner...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Contacts Section -->
                <section id="contacts-section" class="section-content hidden">
                    <div class="bg-white rounded-xl shadow-md p-6" data-aos="fade-up">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800">Kelola Kontak</h3>
                            <button id="addContactBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition duration-300">
                                <i class="fas fa-plus mr-2"></i> Tambah Kontak
                            </button>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead class="bg-blue-50">
                                    <tr>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Jenis Kontak</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Nilai</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Status</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="contacts-table-body">
                                    <!-- Data akan diisi oleh JavaScript dari Firestore -->
                                    <tr>
                                        <td colspan="4" class="text-center py-8">
                                            <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                                            <p class="text-gray-500">Memuat data kontak...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Users Section -->
                <section id="users-section" class="section-content hidden">
                    <div class="bg-white rounded-xl shadow-md p-6" data-aos="fade-up">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800">Kelola Pengguna</h3>
                            <button id="addUserBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition duration-300">
                                <i class="fas fa-plus mr-2"></i> Tambah Pengguna
                            </button>
                        </div>
                        
                        <div class="mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-gray-700 mb-2">Cari Pengguna:</label>
                                    <input type="text" id="searchUser" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nama pengguna...">
                                </div>
                                <div>
                                    <label class="block text-gray-700 mb-2">Filter:</label>
                                    <select id="filterUser" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="all">Semua Pengguna</option>
                                        <option value="admin">Admin</option>
                                        <option value="user">Pengguna</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead class="bg-blue-50">
                                    <tr>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Nama</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Email</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Peran</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Status</th>
                                        <th class="py-3 px-4 text-left font-semibold text-gray-700">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="users-table-body">
                                    <!-- Data akan diisi oleh JavaScript dari Firestore -->
                                    <tr>
                                        <td colspan="5" class="text-center py-8">
                                            <div class="loading-spinner mx-auto mb-4" style="width: 30px; height: 30px;"></div>
                                            <p class="text-gray-500">Memuat data pengguna...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Add/Edit Modal -->
    <div id="dataModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 id="modalTitle" class="text-xl font-bold text-gray-800">Tambah Data</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="dataForm" class="space-y-4">
                <div id="formFields">
                    <!-- Form fields will be dynamically generated based on the data type -->
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" id="cancelBtn" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition duration-300">
                        Batal
                    </button>
                    <button type="submit" id="submitBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition duration-300 flex items-center">
                        <i class="fas fa-save mr-2"></i> Simpan
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA1kevuJ9mRJ8le8uPXin11uUqJ6sOLopY",
            authDomain: "vlcrave-whatsapp-order.firebaseapp.com",
            projectId: "vlcrave-whatsapp-order",
            storageBucket: "vlcrave-whatsapp-order.firebasestorage.app",
            messagingSenderId: "796602954067",
            appId: "1:796602954067:web:e10a110ae904decdc471a6",
            measurementId: "G-XLWNDN39ZD"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // Global variables
        let currentUser = null;
        let currentEditingId = null;
        let currentCollection = '';

        // Initialize AOS
        AOS.init({
            duration: 800,
            once: true
        });

        // Check authentication state
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                document.getElementById('adminName').textContent = user.displayName || user.email;
                document.getElementById('headerAdminName').textContent = user.displayName || user.email.split('@')[0];
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('loadingOverlay').style.display = 'none';
                loadAllData();
            } else {
                document.getElementById('loginModal').style.display = 'flex';
                document.getElementById('loadingOverlay').style.display = 'none';
            }
        });

        // Login form handler
        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            document.getElementById('submitBtn').innerHTML = '<div class="loading"></div> Memproses...';
            document.getElementById('submitBtn').disabled = true;
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    Swal.fire({
                        title: 'Berhasil!',
                        text: 'Login berhasil, mengarahkan ke dashboard...',
                        icon: 'success',
                        timer: 1500,
                        showConfirmButton: false
                    });
                })
                .catch((error) => {
                    console.error('Login error:', error);
                    Swal.fire({
                        title: 'Error!',
                        text: 'Email atau password salah',
                        icon: 'error',
                        confirmButtonText: 'Coba Lagi'
                    });
                    
                    document.getElementById('submitBtn').innerHTML = '<i class="fas fa-sign-in-alt mr-2"></i> Masuk';
                    document.getElementById('submitBtn').disabled = false;
                });
        });

        // Logout handler
        document.getElementById('logoutBtn').addEventListener('click', () => {
            Swal.fire({
                title: 'Konfirmasi',
                text: 'Apakah Anda yakin ingin keluar?',
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Ya, Keluar',
                cancelButtonText: 'Batal'
            }).then((result) => {
                if (result.isConfirmed) {
                    auth.signOut().then(() => {
                        window.location.reload();
                    });
                }
            });
        });

        // Sidebar toggle
        document.getElementById('sidebar-toggle').addEventListener('click', () => {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            
            sidebar.classList.toggle('collapsed');
            mainContent.classList.toggle('expanded');
        });

        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Remove active class from all links
                document.querySelectorAll('.nav-link').forEach(item => {
                    item.classList.remove('active-nav');
                });
                
                // Add active class to clicked link
                link.classList.add('active-nav');
                
                // Hide all sections
                document.querySelectorAll('.section-content').forEach(section => {
                    section.classList.add('hidden');
                });
                
                // Show selected section
                const sectionId = link.getAttribute('data-section') + '-section';
                document.getElementById(sectionId).classList.remove('hidden');
                
                // Update page title
                updatePageTitle(link.getAttribute('data-section'));
            });
        });

        // Update page title based on section
        function updatePageTitle(section) {
            const titles = {
                'dashboard': 'Dashboard',
                'shipping': 'Harga Ongkir',
                'areas': 'Area Layanan',
                'hours': 'Jam Operasional',
                'services': 'Layanan',
                'partners': 'Partner',
                'contacts': 'Kontak',
                'users': 'Pengguna'
            };
            
            const subtitles = {
                'dashboard': 'Ringkasan dan statistik VLCrave Express',
                'shipping': 'Kelola harga ongkir berdasarkan lokasi',
                'areas': 'Kelola area layanan VLCrave Express',
                'hours': 'Kelola jam operasional layanan',
                'services': 'Kelola berbagai layanan yang tersedia',
                'partners': 'Kelola partner bisnis VLCrave Express',
                'contacts': 'Kelola informasi kontak perusahaan',
                'users': 'Kelola pengguna sistem admin'
            };
            
            document.getElementById('pageTitle').textContent = titles[section];
            document.getElementById('pageSubtitle').textContent = subtitles[section];
        }

        // Modal handlers
        document.getElementById('closeModal').addEventListener('click', () => {
            document.getElementById('dataModal').style.display = 'none';
        });

        document.getElementById('cancelBtn').addEventListener('click', () => {
            document.getElementById('dataModal').style.display = 'none';
        });

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            const modal = document.getElementById('dataModal');
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });

        // Add button handlers
        document.getElementById('addShippingBtn').addEventListener('click', () => {
            openModal('shipping_prices', 'Tambah Data Harga Ongkir');
        });

        document.getElementById('addAreaBtn').addEventListener('click', () => {
            openModal('areas', 'Tambah Area Layanan');
        });

        document.getElementById('addHourBtn').addEventListener('click', () => {
            openModal('operational_hours', 'Tambah Jam Operasional');
        });

        document.getElementById('addServiceBtn').addEventListener('click', () => {
            openModal('services', 'Tambah Layanan');
        });

        document.getElementById('addPartnerBtn').addEventListener('click', () => {
            openModal('partners', 'Tambah Partner');
        });

        document.getElementById('addContactBtn').addEventListener('click', () => {
            openModal('contact_info', 'Tambah Kontak');
        });

        document.getElementById('addUserBtn').addEventListener('click', () => {
            openModal('users', 'Tambah Pengguna');
        });

        // Open modal for adding/editing data
        function openModal(collection, title, id = null) {
            currentCollection = collection;
            currentEditingId = id;
            
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('dataModal').style.display = 'flex';
            
            // Generate form fields based on collection
            generateFormFields(collection, id);
        }

        // Generate form fields based on collection type
        function generateFormFields(collection, id = null) {
            const formFields = document.getElementById('formFields');
            formFields.innerHTML = '';
            
            // Define field configurations for each collection
            const fieldConfigs = {
                'shipping_prices': [
                    { name: 'kecamatan', label: 'Kecamatan', type: 'text', required: true },
                    { name: 'desa', label: 'Desa/Kelurahan', type: 'text', required: true },
                    { name: 'harga', label: 'Harga Ongkir', type: 'number', required: true },
                    { name: 'status', label: 'Status', type: 'select', options: ['active', 'inactive'], required: true }
                ],
                'areas': [
                    { name: 'name', label: 'Nama Area', type: 'text', required: true },
                    { name: 'villageCount', label: 'Jumlah Desa', type: 'number', required: true },
                    { name: 'isCenter', label: 'Pusat Layanan', type: 'checkbox', required: false },
                    { name: 'status', label: 'Status', type: 'select', options: ['active', 'inactive'], required: true }
                ],
                'operational_hours': [
                    { name: 'day', label: 'Hari', type: 'text', required: true },
                    { name: 'hours', label: 'Jam Operasional', type: 'text', required: true },
                    { name: 'status', label: 'Status', type: 'select', options: ['active', 'inactive'], required: true }
                ],
                'services': [
                    { name: 'name', label: 'Nama Layanan', type: 'text', required: true },
                    { name: 'description', label: 'Deskripsi', type: 'textarea', required: true },
                    { name: 'icon', label: 'Ikon (Font Awesome)', type: 'text', required: true },
                    { name: 'color', label: 'Warna', type: 'select', options: ['blue', 'green', 'red', 'yellow', 'purple', 'pink'], required: true },
                    { name: 'status', label: 'Status', type: 'select', options: ['active', 'inactive'], required: true }
                ],
                'partners': [
                    { name: 'name', label: 'Nama Partner', type: 'text', required: true },
                    { name: 'description', label: 'Deskripsi', type: 'textarea', required: true },
                    { name: 'logo', label: 'URL Logo', type: 'text', required: false },
                    { name: 'status', label: 'Status', type: 'select', options: ['active', 'inactive'], required: true }
                ],
                'contact_info': [
                    { name: 'type', label: 'Jenis Kontak', type: 'select', options: ['whatsapp', 'facebook', 'instagram', 'email', 'phone'], required: true },
                    { name: 'value', label: 'Nilai', type: 'text', required: true },
                    { name: 'status', label: 'Status', type: 'select', options: ['active', 'inactive'], required: true }
                ],
                'users': [
                    { name: 'name', label: 'Nama Lengkap', type: 'text', required: true },
                    { name: 'email', label: 'Email', type: 'email', required: true },
                    { name: 'password', label: 'Password', type: 'password', required: id ? false : true },
                    { name: 'role', label: 'Peran', type: 'select', options: ['admin', 'user'], required: true },
                    { name: 'status', label: 'Status', type: 'select', options: ['active', 'inactive'], required: true }
                ]
            };
            
            const fields = fieldConfigs[collection] || [];
            
            fields.forEach(field => {
                const fieldDiv = document.createElement('div');
                
                if (field.type === 'checkbox') {
                    fieldDiv.innerHTML = `
                        <div class="flex items-center">
                            <input type="checkbox" id="${field.name}" name="${field.name}" class="mr-2 h-5 w-5 text-blue-500 rounded">
                            <label for="${field.name}" class="text-gray-700">${field.label}</label>
                        </div>
                    `;
                } else if (field.type === 'select') {
                    fieldDiv.innerHTML = `
                        <label for="${field.name}" class="block text-gray-700 mb-2">${field.label}${field.required ? ' *' : ''}</label>
                        <select id="${field.name}" name="${field.name}" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" ${field.required ? 'required' : ''}>
                            <option value="">Pilih ${field.label}</option>
                            ${field.options.map(option => `<option value="${option}">${option.charAt(0).toUpperCase() + option.slice(1)}</option>`).join('')}
                        </select>
                    `;
                } else if (field.type === 'textarea') {
                    fieldDiv.innerHTML = `
                        <label for="${field.name}" class="block text-gray-700 mb-2">${field.label}${field.required ? ' *' : ''}</label>
                        <textarea id="${field.name}" name="${field.name}" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" ${field.required ? 'required' : ''}></textarea>
                    `;
                } else {
                    fieldDiv.innerHTML = `
                        <label for="${field.name}" class="block text-gray-700 mb-2">${field.label}${field.required ? ' *' : ''}</label>
                        <input type="${field.type}" id="${field.name}" name="${field.name}" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" ${field.required ? 'required' : ''}>
                    `;
                }
                
                formFields.appendChild(fieldDiv);
            });
            
            // If editing, load existing data
            if (id) {
                loadDataForEditing(collection, id);
            }
        }

        // Load data for editing
        function loadDataForEditing(collection, id) {
            db.collection(collection).doc(id).get()
                .then((doc) => {
                    if (doc.exists) {
                        const data = doc.data();
                        
                        // Populate form fields with existing data
                        Object.keys(data).forEach(key => {
                            const field = document.getElementById(key);
                            if (field) {
                                if (field.type === 'checkbox') {
                                    field.checked = data[key];
                                } else {
                                    field.value = data[key];
                                }
                            }
                        });
                    }
                })
                .catch((error) => {
                    console.error('Error loading data for editing:', error);
                    Swal.fire({
                        title: 'Error!',
                        text: 'Gagal memuat data untuk diedit',
                        icon: 'error'
                    });
                });
        }

        // Form submission handler
        document.getElementById('dataForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            // Handle checkbox values
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                data[checkbox.name] = checkbox.checked;
            });
            
            // Show loading state
            document.getElementById('submitBtn').innerHTML = '<div class="loading"></div> Menyimpan...';
            document.getElementById('submitBtn').disabled = true;
            
            if (currentEditingId) {
                // Update existing document
                db.collection(currentCollection).doc(currentEditingId).update(data)
                    .then(() => {
                        Swal.fire({
                            title: 'Berhasil!',
                            text: 'Data berhasil diperbarui',
                            icon: 'success',
                            timer: 1500,
                            showConfirmButton: false
                        });
                        
                        document.getElementById('dataModal').style.display = 'none';
                        loadAllData();
                    })
                    .catch((error) => {
                        console.error('Error updating document:', error);
                        Swal.fire({
                            title: 'Error!',
                            text: 'Gagal memperbarui data',
                            icon: 'error'
                        });
                    })
                    .finally(() => {
                        document.getElementById('submitBtn').innerHTML = '<i class="fas fa-save mr-2"></i> Simpan';
                        document.getElementById('submitBtn').disabled = false;
                    });
            } else {
                // Add new document
                db.collection(currentCollection).add(data)
                    .then(() => {
                        Swal.fire({
                            title: 'Berhasil!',
                            text: 'Data berhasil ditambahkan',
                            icon: 'success',
                            timer: 1500,
                            showConfirmButton: false
                        });
                        
                        document.getElementById('dataModal').style.display = 'none';
                        loadAllData();
                    })
                    .catch((error) => {
                        console.error('Error adding document:', error);
                        Swal.fire({
                            title: 'Error!',
                            text: 'Gagal menambahkan data',
                            icon: 'error'
                        });
                    })
                    .finally(() => {
                        document.getElementById('submitBtn').innerHTML = '<i class="fas fa-save mr-2"></i> Simpan';
                        document.getElementById('submitBtn').disabled = false;
                    });
            }
        });

        // Load all data from Firestore
        function loadAllData() {
            // This is a simplified version. In a real app, you would load data for each section
            console.log('Loading data from Firestore...');
            
            // Load shipping prices
            loadShippingData();
            
            // Load other data as needed...
        }

        // Load shipping data
        function loadShippingData() {
            db.collection('shipping_prices').get()
                .then((querySnapshot) => {
                    const tableBody = document.getElementById('shipping-table-body');
                    tableBody.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        tableBody.innerHTML = `
                            <tr>
                                <td colspan="5" class="text-center py-8 text-gray-500">
                                    <i class="fas fa-inbox text-4xl mb-4 block"></i>
                                    Tidak ada data harga ongkir
                                </td>
                            </tr>
                        `;
                        return;
                    }
                    
                    querySnapshot.forEach((doc) => {
                        const data = doc.data();
                        const row = document.createElement('tr');
                        
                        row.innerHTML = `
                            <td class="py-3 px-4">${data.kecamatan || '-'}</td>
                            <td class="py-3 px-4">${data.desa || '-'}</td>
                            <td class="py-3 px-4">Rp ${data.harga ? data.harga.toLocaleString('id-ID') : '0'}</td>
                            <td class="py-3 px-4">
                                <span class="px-2 py-1 rounded-full text-xs font-medium ${data.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                    ${data.status === 'active' ? 'Aktif' : 'Nonaktif'}
                                </span>
                            </td>
                            <td class="py-3 px-4">
                                <button class="edit-btn text-blue-500 hover:text-blue-700 mr-2" data-id="${doc.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="delete-btn text-red-500 hover:text-red-700" data-id="${doc.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        `;
                        
                        tableBody.appendChild(row);
                    });
                    
                    // Add event listeners to edit and delete buttons
                    document.querySelectorAll('.edit-btn').forEach(button => {
                        button.addEventListener('click', (e) => {
                            const id = e.currentTarget.getAttribute('data-id');
                            openModal('shipping_prices', 'Edit Data Harga Ongkir', id);
                        });
                    });
                    
                    document.querySelectorAll('.delete-btn').forEach(button => {
                        button.addEventListener('click', (e) => {
                            const id = e.currentTarget.getAttribute('data-id');
                            deleteData('shipping_prices', id);
                        });
                    });
                    
                    // Update count
                    document.getElementById('shipping-count').textContent = querySnapshot.size;
                })
                .catch((error) => {
                    console.error('Error loading shipping data:', error);
                    const tableBody = document.getElementById('shipping-table-body');
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="text-center py-8 text-red-500">
                                <i class="fas fa-exclamation-triangle text-4xl mb-4 block"></i>
                                Gagal memuat data
                            </td>
                        </tr>
                    `;
                });
        }

        // Delete data
        function deleteData(collection, id) {
            Swal.fire({
                title: 'Konfirmasi',
                text: 'Apakah Anda yakin ingin menghapus data ini?',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Ya, Hapus',
                cancelButtonText: 'Batal'
            }).then((result) => {
                if (result.isConfirmed) {
                    db.collection(collection).doc(id).delete()
                        .then(() => {
                            Swal.fire({
                                title: 'Berhasil!',
                                text: 'Data berhasil dihapus',
                                icon: 'success',
                                timer: 1500,
                                showConfirmButton: false
                            });
                            
                            loadAllData();
                        })
                        .catch((error) => {
                            console.error('Error deleting document:', error);
                            Swal.fire({
                                title: 'Error!',
                                text: 'Gagal menghapus data',
                                icon: 'error'
                            });
                        });
                }
            });
        }

        // Initialize charts
        function initializeCharts() {
            // Orders Chart
            const ordersCtx = document.getElementById('ordersChart').getContext('2d');
            const ordersChart = new Chart(ordersCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun'],
                    datasets: [{
                        label: 'Pesanan',
                        data: [120, 190, 300, 500, 200, 300],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Services Chart
            const servicesCtx = document.getElementById('servicesChart').getContext('2d');
            const servicesChart = new Chart(servicesCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Makanan', 'Barang', 'Dokumen', 'Lainnya'],
                    datasets: [{
                        data: [40, 30, 20, 10],
                        backgroundColor: [
                            '#3b82f6',
                            '#10b981',
                            '#f59e0b',
                            '#8b5cf6'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
        });

        console.log('VLCrave Express Admin Dashboard loaded successfully!');
    </script>
</body>
</html>
